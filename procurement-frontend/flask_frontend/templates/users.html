{% extends "base.html" %}
{% block title %}Benutzerverwaltung{% endblock %}

{% block content %}
<h3 class="mb-4">Benutzer</h3>
<a href="{{ url_for('users_create') }}" class="btn btn-sm btn-success mb-3">
    <i class="bi bi-plus"></i> Neuer Benutzer
</a>
<table class="table table-sm table-hover" id="users-table">
    <thead><tr><th>E-Mail</th><th>Aktiv</th><th>Super</th><th>Aktion</th></tr></thead>
    <tbody></tbody>
</table>
{% endblock %}

{% block script %}
<script>
fetch('{{ API_URL }}/admin/users', { headers: authHeader() })
  .then(r => r.json())
  .then(users => {
    const tbody = document.querySelector('#users-table tbody');
    users.forEach(u => tbody.insertAdjacentHTML('beforeend', `
      <tr>
        <td>${u.email}</td>
        <td>${u.is_active ? "✅" : "❌"}</td>
        <td>${u.is_superuser ? "👑" : ""}</td>
        <td>
          <a href="{{ url_for('users_create') }}?id=${u.id}" class="btn btn-sm btn-outline-primary">
            Edit
          </a>
        </td>
      </tr>`));
  });
</script>
{% endblock %}
